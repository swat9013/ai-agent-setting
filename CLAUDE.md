# AI Context Template

## プロジェクト概要

AIコーディングアシスタント（Cursor、Claude Code、GitHub Copilot等）向けの
コンテキスト管理テンプレート。プロジェクトに導入して使う。

### ゴール

1. **コンテキストの成長** - 会話から得た知見を蓄積し、プロジェクトとともに進化
2. **確実な実行** - 育てた知見がAIに確実に参照・実行される仕組み

## リポジトリ構造

```
├── template/          # 配布される本体（ここを編集）
├── .claude/skills/    # Claude Code専用Skills（このリポジトリ固有）
├── docs/              # 設計書・ガイド
├── examples/          # 技術スタック別サンプル
├── install.sh         # インストーラー
└── CHANGELOG.md       # 変更履歴（リリース時に更新必須）
```

### Skills

| Skill | 用途 |
|-------|------|
| context-advisor | template/配下のコンテキストファイル改善アドバイザー |

## 開発方針

### コンテキスト設計の原則
- 最小限の高シグナル情報で効果を最大化
- 適切な抽象度を保つ（硬直的すぎず、曖昧すぎず）
- 詳細リンクは「分離した場合のみ」追加（デフォルトで書かない）
  - 全セクションにリンクがあるとAIが無駄に探索する
- 分量が少なく常に参照されるべき内容は分離せず統合する
  - ファイル分離 → 参照 → 読み込みのオーバーヘッドを避ける

### ファイル編集時の注意

| ファイル | 注意点 |
|---------|--------|
| template/.ai/context.md | プロジェクトのコーディング方針を記載。コンテキスト記述ルール自体は書かない。穴埋め形式を維持 |
| template/.ai/agents/*.md | 対話向け（設計相談等）のみ。アクション実行はコマンドへ |
| template/.ai/commands/*.md | ツール非依存を維持。1:1対応ならエージェントと統合。詳細は references/ に分離 |
| template/.ai/references/ | チェックリスト・テンプレート等の参照用ファイル |
| template/.ai/scripts/*.py | Python 3 標準ライブラリのみ使用（追加インストール不要） |
| examples/**/context.md | 実際に使える具体例を記載 |
| plan.md | 一時ファイル。docs/やwork/に保存しない。プロジェクトルートに配置し実装後削除 |
| implementation.md | plan.md から生成される実行計画。プロジェクトルートに配置し実装後削除 |

### エージェント vs コマンドの使い分け

| 種類 | 用途 | 例 |
|-----|------|-----|
| エージェント | 対話・相談向け | architect（設計相談） |
| コマンド | アクション実行 | /code-review（レビュー実行） |

**判断基準**:
- 1:1対応ならコマンドに統合してシンプルに保つ
- 一つのことをうまくやる（Unix哲学）: 複合機能は分離（例: breakdown と implement）

### コマンド設計パターン

確実な実行を担保するため、コマンドには以下を含める:

| 要素 | 目的 |
|-----|------|
| 前提条件 | 実行前の検証。満たさない場合は中止 |
| 番号付き実行手順 | 順序の明確化 |
| 完了チェックリスト | 報告前の自己検証 |

テンプレート: `template/.ai/references/templates/command.md`

### コンテキスト蓄積方針

- **要約** → `context.md` の「重要な設計判断」等（常にAIが参照）
- **詳細** → `docs/decisions/` 等（必要時に参照）

memory/ 的な専用ディレクトリは作らず、docs/ への蓄積 + context.md での要約参照で対応。

### 破壊的変更の定義
- template/ のディレクトリ構造変更
- コマンド名の変更
- 必須ファイルの追加・削除

## リリース手順

1. CHANGELOG.md を更新
2. バージョンタグを作成: `git tag v1.x.x`
3. プッシュ: `git push origin v1.x.x`

## 開発ツール

### コンテキスト規模の計測

```bash
python3 template/.ai/scripts/measure-context.py
```

コンテキストファイルの行数・トークン数を計測。閾値超過をチェック。

| オプション | 対象 | 閾値（トークン: 推奨/上限） |
|-----------|------|---------------------------|
| --context | .ai/context.md | 1,500 / 2,000 |
| --agents | .ai/agents/*.md | 3,000 / 5,000 |
| --commands | .ai/commands/*.md | 1,500 / 2,000 |
| --references | .ai/references/**/*.md | 3,000 / 5,000 |
| --docs | docs/**/*.md | 3,000 / 5,000 |

## よくある改善パターン

- 新しい技術スタックの examples/ 追加
- コマンドテンプレートの改善
- スクリプトのバグ修正・機能追加
- ドキュメントの明確化
