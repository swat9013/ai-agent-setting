# /debug Command

バグ調査・デバッグを支援し、根本原因の特定と修正案を提示する。

## 使用方法

```bash
# エラーメッセージから調査
/debug TypeError: Cannot read property 'x' of undefined

# バグの説明から調査
/debug ログイン後にセッションが切れる問題

# ログファイルから調査
/debug logs/error.log
```

## 処理フロー

### Phase 1: 状況把握

1. **問題の特定**
   - エラーメッセージ/スタックトレースの分析
   - 再現手順の確認
   - 発生頻度・影響範囲の把握

2. **問題種別の分類**
   - ランタイムエラー（TypeError, NullPointer等）
   - ロジックエラー（期待と異なる動作）
   - パフォーマンス問題（遅い、メモリリーク）
   - 外部連携エラー（API、DB、ネットワーク）

### Phase 2: 原因特定

1. **コード調査**
   - エラー発生箇所の特定
   - 関連コードの読み込み
   - 呼び出し元・影響範囲の追跡

2. **仮説立案**
   - 直接原因（何が起きているか）
   - 根本原因（なぜ起きているか）
   - 技術的背景（設計 or 実装の問題か）

3. **検証**
   - ログ・デバッガでの確認
   - 最小再現コードの作成
   - 仮説の検証

### Phase 3: 対応判定

| 種別 | 対応 |
|------|------|
| 単純バグ | 即修正 + テスト追加 |
| 技術的負債 | パッチ + 報告（docs/に記録） |

**単純バグの例**: タイポ、境界値漏れ、null未チェック
**技術的負債の例**: 設計上の欠陥、大規模リファクタリング必要

## 出力形式

```markdown
# デバッグレポート

## 問題概要
- 症状: [観察された問題]
- エラー: [エラーメッセージ（あれば）]

## 調査結果
- 直接原因: [何が起きているか]
- 根本原因: [なぜ起きているか]
- 影響範囲: [ファイル/機能]

## 対応判定
[単純バグ / 技術的負債]

## 修正案
### 短期（パッチ）
[具体的な修正内容]

### テスト追加
[追加すべきテストケース]

### 長期（必要な場合）
[構造的な改善が必要な場合の提案]

## 次のアクション
1. [ステップ1]
2. [ステップ2]
```

## デバッグのヒント

### よくあるパターン

| エラータイプ | よくある原因 | 確認ポイント |
|-------------|-------------|-------------|
| null/undefined | 初期化漏れ、非同期処理 | データフロー追跡 |
| 型エラー | 型変換ミス、API応答形式 | 入出力の型確認 |
| N+1クエリ | eager loading不足 | クエリログ確認 |
| 認証エラー | トークン期限、権限設定 | 認証フロー確認 |

### 調査の原則

- **5 Whys**: 「なぜ？」を5回繰り返して根本原因へ
- **仮説駆動**: 推測→検証のサイクル
- **最小再現**: 問題を再現する最小のコードを特定
